use("KetCindyPlugin");
Dircdy=loaddirectory;
setdirectory(gethome());
import("ketcindy.ini");

setdirectory(Dircdy);
import("libfornet.txt");

Id=51;
Rec=59;
Que=[10,11,12];

import("libketlib.txt");

Msgnew=[];
Msghint=[];
Msggues=[];
Msgsc=[];

graphflg=0;

Msgtest=[];


Msgtest=[];
sta=[];

//////////////////figures

Ketinit();
//Addax(0);
if(newflg==1,
  pos=[-7.8,3.8];
  Msgnew=Newsession(Id,"",pos,20);
  if(confirmflg==1,
    Msgnew=["出題=>",pos,20,[0,0,1]];
    Startlearning(Id);
    newflg=0;
    quesnew=1;
    confirmflg=0;
  );
);

if(quesflg==1,
  if(quesnew==1,
    Subsedit(Rec,"");
    Msgnew=[];
    out=Makeques([-13,2.8],20,[0,0,0]);
    Ex=out_1; Ca=out_2;
    Msgques=out_3;
    Startquestion(out_1,out_2);
  );  
  quesflg=0;
);

if(tipsflag==1,
  ans=parse(Ca);
  Msghint=["ヒント：解の１つは  $x="+text(ans_1)+"$",[-13,-2],20];
  tipsflag=0;
);

if(graphflg==1,
  Drawgraph(Ex,[-3,4.5],18);
);

if(scoreflg==1,
  out=Scoring(Ca);
  Makequesdata(out_1,out_2);
  Updatelog();
  scorefin=1;
  quesnew=1;
  scoreflg=0;
);

if(recordflg==1,
  if(scorefin==1,
    Subsedit(Rec,LogData);
    quesnew=1;
  );
  recordflg=0;
);

Displetterlist([Msgnew,Msgques,Msghint,Msgsc]);

Windispg();
